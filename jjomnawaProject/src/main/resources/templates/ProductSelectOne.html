<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${session.title}">title</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
<!-- 헤더 포함 -->
<div th:replace="fragments/header :: header"></div>


<div class="container mt-5">
    <h1>Product Information Update</h1>
    <form action="#" th:action="@{/p/selectone/{productId}(productId=${product.productId})}" method="post">

        <div class="form-row">
            <div class="col-2">
                <label for="insertProductCategoryId">Category ID</label>
                <input type="text" class="form-control" id="insertProductCategoryId" name="categoryId" th:value="${product.categoryId}" readonly>
            </div>
            <div class="col-10">
                <label for="name">Product Name</label>
                <input type="text" class="form-control" id="name" name="name" th:value="${product.name}" required>
            </div>
        </div>

        <!-- C Code / C URL -->
        <div class="form-row">
            <div class="col-2">
                <label for="cCode">C Code</label>
                <input type="text" class="form-control" id="cCode" name="cCode" th:value="${product.cCode}" required>
            </div>
            <div class="col-10">
                <label for="cUrl">C URL</label>
                <input type="text" class="form-control" id="cUrl" name="cUrl" th:value="${product.cUrl}" required>
            </div>
        </div>

        <!-- I Code / I URL -->
        <div class="form-row">
            <div class="col-2">
                <label for="iCode">I Code</label>
                <input type="text" class="form-control" id="iCode" name="iCode" th:value="${product.iCode}" required>
            </div>
            <div class="col-10">
                <label for="iUrl">I URL</label>
                <input type="text" class="form-control" id="iUrl" name="iUrl" th:value="${product.iUrl}" required>
            </div>
        </div>

        <!-- J Code / J URL -->
        <div class="form-row">
            <div class="col-2">
                <label for="jCode">J Code</label>
                <input type="text" class="form-control" id="jCode" name="jCode" th:value="${product.jCode}" required>
            </div>
            <div class="col-10">
                <label for="jUrl">J URL</label>
                <input type="text" class="form-control" id="jUrl" name="jUrl" th:value="${product.jUrl}" required>
            </div>
        </div>

        <button type="submit" class="btn btn-primary">Update</button>
        <button type="button" class="btn btn-warning" id="deleteButton" th:data-product_id="${product.productId}">Delete</button>
        <button type="button" class="btn btn-primary" id="listButton">List</button>
    </form>
</div>




<!-- 푸터 포함 -->
<div th:replace="fragments/footer :: footer"></div>
<script>
$(document).ready(function() {
    $('#listButton').on('click', function() {
        window.location.href = "/p/list";
    });
    $('#deleteButton').on('click', function() {
        var productId = $('#deleteButton').data('product_id');
        $.ajax({
            url: '/p/delete/' + productId,
            method: 'POST',
            success: function (response) {
                console.log(response);
                if(response.message == "success") {
                    window.location.href = "/p/list";
                }
            },
            error: function (xhr, status, error) {
                alert('Error: ' + error);
            }
        });
    });

    $.ajax({
        url: '/test',
        method: 'GET',
        success: function (response) {
            console.log(response);
        },
        error: function (xhr, status, error) {
            alert('Error: ' + error);
        }
    });

    //const currentCategoryId = $('#categoryId').val(currentCategoryId);

});
</script>
</body>
</html>
